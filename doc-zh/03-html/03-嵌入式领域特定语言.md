# 3.3.Embedded Domain-Specific Languages

我们马上就会在 Haskell 中遇到一个常见模式：创建嵌入式领域特定语言（简称 EDSL）。

领域特定语言 (DSL) 是专门针对特定领域的编程语言，与试图在许多领域中良好工作的通用语言不同。

DSL的一些示例是：

- make - 用于定义构建系统
- DOT - 用于定义图形
- Sed - 用于定义文本转换
- CSS - 用于定义样式
- HTML - 用于定义网页

嵌入式领域特定语言是一种嵌入在另一种编程语言中的小语言，使用 EDSL 编写的程序成为用其编写的语言编写的有效程序。

我们一直在编写的小型HTML库可以被视为EDSL。它专门用于构建网页（通过返回HTML字符串），并且是有效的Haskell代码！

在Haskell中，我们经常创建和使用EDSL来表达领域特定逻辑。我们有用于并发、命令行选项解析、JSON和HTML、创建构建系统、编写测试等的EDSL。

专用语言很有用，因为它们可以以简洁（且通常安全）的方式解决特定问题，并且通过嵌入，我们可以充分利用宿主语言的全部功能来实现域逻辑，包括语法突出显示和可用于该语言的各种工具。

嵌入领域特定语言的缺点是我们必须遵守嵌入的编程语言的规则，例如句法和语义规则。

一些语言通过以宏或其他功能的形式提供元编程功能来扩展语言，从而缓解了这一缺点。虽然 Haskell 也提供了这样的功能，但它也足够富有表现力和简洁，许多EDSL不需要它们。

相反，许多Haskell EDSL使用一种称为组合器模式的模式：它们定义原语和组合器 - 原语是语言的基本构建块，而组合器是将原语组合成更复杂结构的函数。

在我们的HTML EDSL中，我们的原语是诸如`html_`和`title_`之类的函数，可用于创建单个HTML节点，我们将其他构造的节点作为输入传递给这些函数，并使用附加函数`<>`将它们组合成更复杂的结构。 

我们还可以采用一些技巧来改进我们的HTML EDSL：

我们可以使用Haskell的类型系统来确保我们只构造有效的HTML，例如，我们不会创建没有`<head>`节点的`<title>`节点，也不会让用户内容包含未转义的特殊字符，并在用户尝试执行无效操作时抛出类型错误。

我们的HTML EDSL可以移动到自己的模块，以便可以在多个模块中重复使用。

在接下来的几节中，我们将了解如何定义我们自己的类型以及如何使用模块以使其更难出错，以及一些关于Haskell中的链表的内容。